<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/style/style.css">
    <link rel="stylesheet" href="assets/style/footernav.css">
    <script src="assets/js/main.js"></script>
    <title>Notredame Library</title>
</head>

<body>
    <nav class="navbar">
        <img style="width:4%; margin-left:2%;" id='imgLogo' onclick=" location.href = 'index.html' "
            src="https://lareja.fsspx.org/sites/sspx/files/styles/colorbox-big/public/corazones_2.png" alt="">
        <ul>
            <li><a href='livros.html'>Livros (beta) </a></li>
            <li><a href='cantos.html'>Cantos </a></li>
            <li id='cadastroLi'><a href='cadastro-login/cadastro.html'>Cadastro </a></li>
            <li id="usuarioNome"><a href='cadastro-login/login.html'>Login </a></li>
        </ul>
    </nav>

    <div class="conteudo">
        <div class="paragrafo" id="paragrafoCantoCadastro">
            <div class="texto">


                <div class="tituloCantoCard">

                    <span class="tituloHeader">Cadastrar canto</span>
                    <p>Se quiser contribuir com o nosso projeto, cadastre aqui um canto!</p>
                    <button id="botaoIndividual"
                        onclick=" location.href = 'cadastro-login/cadastro_cantos.html'  ">Cadastrar canto</button>
                </div>

                <div class="alinhar">
                    <div class="alinhamento"></div>
                </div>
                <div class="estatistica">
                    <p>Usuário que mais cadastrou: <span id="usuarioMaisCadastroSpan"></span> <br>
                        Cantos postados: <span id="cantosPostados"></span>

                    </p>
                </div>
            </div>

            <br>


        </div>

        <div id="paragrafos">
            <div class="paragrafoCantos" id="paragrafoCanto0">
                <!--  <div class="cardCatalogoCantos">
                        <div class="tituloCardCantos">
                            <a href='cantoEscolhido.html'> Regina Caeli </a>
                            <div class="subtituloHeader">Autor Canto</div>
                        </div>
    
                        <div class="capaCanto">
                            <img class="capaCantoImagem" src="https://images-ext-2.discordapp.net/external/1Kbz2DM7WsLYcmyN0lSIF74NHW11FBuOzr458WUI1zo/https/i.pinimg.com/564x/1e/70/fe/1e70fe124f52f0ff3a35d366f93ca700.jpg?width=352&height=457"
                                alt="">
                        </div>
    
                    </div>
               
    
                    <div class="cardCatalogoCantos">
                        <div class="tituloCardCantos">
                            <a href='cantoEscolhido.html'> Regina Caeli </a>
                            <div class="subtituloHeader">Autor Canto</div>
                        </div>
    
                        <div class="capaCanto">
                            <img class="capaCantoImagem" src="https://images-ext-2.discordapp.net/external/1Kbz2DM7WsLYcmyN0lSIF74NHW11FBuOzr458WUI1zo/https/i.pinimg.com/564x/1e/70/fe/1e70fe124f52f0ff3a35d366f93ca700.jpg?width=352&height=457"
                                alt="">
                        </div>
    
                    </div>
    
                    <div class="cardCatalogoCantos">
                        <div class="tituloCardCantos">
                            <a href='cantoEscolhido.html'> Regina Caeli </a>
                            <div class="subtituloHeader">Autor Canto</div>
                        </div>
    
                        <div class="capaCanto">
                            <img class="capaCantoImagem" src="https://images-ext-2.discordapp.net/external/1Kbz2DM7WsLYcmyN0lSIF74NHW11FBuOzr458WUI1zo/https/i.pinimg.com/564x/1e/70/fe/1e70fe124f52f0ff3a35d366f93ca700.jpg?width=352&height=457"
                                alt="">
                        </div>
    
                    </div>
                   !-->
            </div>
        </div>


    </div>
    </div>


    <footer>
        <div class="titulo">Notredame</div>
        <div class="blocagemUl">
            <ul>
                <li>Contato</li>
                <li>FAQ</li>
                <li>Catálogo</li>
                <li>Cantos (beta)</li>
            </ul>
            <ul>
                <li>Contato</li>
                <li>FAQ</li>
                <li>Catálogo</li>
                <li>Cantos (beta)</li>
            </ul>

            <ul>
                <li>Contato</li>
                <li>FAQ</li>
                <li>Catálogo</li>
                <li>Cantos (beta)</li>
            </ul>
            <ul>
                <li>Contato</li>
                <li>FAQ</li>
                <li>Catálogo</li>
                <li>Cantos (beta)</li>
            </ul>
        </div>

    </footer>
</body>

</html>
<script>


    function apperPlay(num, nome) {
        if (num == 1) {
            nome.style.display = 'block';
        }
        else if (num == 0) {
            nome.style.display = 'none';
        }
    }




    function localizaId(id) {
        sessionStorage.IDCANTO = id;
    }

    function atualizarFeed() {
        //aguardar();
        fetch("/cantos/listar").then(function (resposta) {
            if (resposta.ok) {

                resposta.json().then(function (resposta) {
                    usuarioMaisCadastro = quemCadastrouMais(resposta)

                    usuarioMaisCadastroSpan.innerHTML = `<b>${usuarioMaisCadastro} </b>`;
                    console.log("Dados recebidos: ", JSON.stringify(resposta));
                    let paragrafo = 0;
                    cantosPostados.innerHTML = `<b>${resposta.length}</b>`

                    for (i = 0; i < resposta.length; i++) {
                        if (resposta[i].urlCapa.indexOf('.jpg') == -1 && resposta[i].urlCapa.indexOf('.png') == -1) {
                            resposta[i].urlCapa = 'https://i.pinimg.com/564x/6f/8b/d5/6f8bd5ad80ca3cc9b3aeb7fe650a4f2b.jpg'
                        }
                        if (i % 3 == 0) {
                            paragrafos.innerHTML += `<div class="paragrafoCantos" id='paragrafoCanto${paragrafo}' </div>`
                            paragrafo++;
                        }

                        document.getElementById(`paragrafoCanto${paragrafo - 1}`).innerHTML += `<div class="cardCatalogoCantos">
                                <div class="tituloCardCantos">
                                    <a href='cantoEscolhido.html' onclick='localizaId(${resposta[i].idCantos})' id='${resposta[i].idCantos}'> ${resposta[i].tituloCanto} </a>
                                    <div class="subtituloHeader">${resposta[i].autorCanto}</div>
                                </div>

                                <div class="capaCanto" >
                                    <img class="capaCantoImagem" src="${resposta[i].urlCapa}"
                                        alt="">
                                </div>
                                <span class='usuarioPostou'><h6> ${resposta[i].nomeUsuario} </h6></span>
                            </div>`


                    }


                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
            finalizarAguardar();
        });
    }
    atualizarFeed()

    function testar() {
        aguardar();

        var formulario = new URLSearchParams(new FormData(document.getElementById("form_postagem")));

        var divResultado = document.getElementById("div_feed");

        divResultado.appendChild(document.createTextNode(formulario.get("descricao")));
        divResultado.innerHTML = formulario.get("descricao");

        finalizarAguardar();

        return false;
    }

    validaNome();
</script>